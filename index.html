<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>36æ ¼ç¿»ç‰ŒæŠ½å¥–ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 12px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #ff9a00, #ff6a00, #ff9a00);
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 6px;
            background: linear-gradient(90deg, #ff9a00, #ff6a00);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .subtitle {
            font-size: 0.9rem;
            color: #aaa;
            margin-bottom: 12px;
        }
        
        .currency-display {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        .currency {
            display: flex;
            align-items: center;
            background: rgba(0, 0, 0, 0.6);
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
        }
        
        .currency i {
            margin-right: 6px;
            font-size: 1rem;
        }
        
        .exploration-coin i {
            color: #00c3ff;
            text-shadow: 0 0 5px #00c3ff;
        }
        
        .spark-coin i {
            color: #ffcc00;
            text-shadow: 0 0 5px #ffcc00;
        }
        
        .stats-info {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        .stats {
            display: flex;
            align-items: center;
            background: rgba(0, 0, 0, 0.6);
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
        }
        
        .stats i {
            margin-right: 6px;
            font-size: 1rem;
            color: #ff6b6b;
        }
        
        .game-tools {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        .tool-btn {
            padding: 6px 12px;
            font-size: 0.8rem;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        }
        
        .tool-btn.add-spark {
            background: linear-gradient(90deg, #ffcc00, #ff9900);
            color: #333;
        }
        
        .tool-btn.reset {
            background: linear-gradient(90deg, #ff6b6b, #ff5252);
            color: white;
        }
        
        .tool-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4);
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .layer-selector {
            flex: 1;
            min-width: 250px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .layer-selector::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, #ff9a00, #ff6a00);
        }
        
        .layer-selector h2 {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.3rem;
            color: #4dabf7;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .layers {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .layer-item {
            background: rgba(0, 0, 0, 0.5);
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .layer-item:hover {
            transform: translateY(-3px);
            background: rgba(0, 0, 0, 0.7);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }
        
        .layer-item.active {
            border-color: #4dabf7;
            background: rgba(77, 171, 247, 0.1);
            box-shadow: 0 0 10px rgba(77, 171, 247, 0.5);
        }
        
        .layer-item.completed {
            border-color: #51cf66;
        }
        
        .layer-item.locked {
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .layer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }
        
        .layer-title {
            font-size: 1.1rem;
            font-weight: bold;
        }
        
        .layer-status {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 15px;
        }
        
        .status-locked {
            background: linear-gradient(90deg, #ff6b6b, #ff8787);
        }
        
        .status-active {
            background: linear-gradient(90deg, #4dabf7, #339af0);
        }
        
        .status-completed {
            background: linear-gradient(90deg, #51cf66, #40c057);
        }
        
        .layer-rewards {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.8rem;
            color: #ccc;
            margin-top: 6px;
            flex-wrap: wrap;
        }
        
        .layer-info {
            font-size: 0.75rem;
            color: #aaa;
            margin-top: 5px;
        }
        
        .game-area {
            flex: 2;
            min-width: 300px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .current-layer-info {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .current-layer-info h3 {
            font-size: 1.3rem;
            margin-bottom: 6px;
            color: #ff9a00;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .cards-container {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 4px;
            margin-bottom: 15px;
            padding: 5px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .card {
            aspect-ratio: 1;
            background: linear-gradient(145deg, #2d3748, #1a202c);
            border-radius: 4px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.4s ease;
            transform-style: preserve-3d;
            position: relative;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .card:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        
        .card.flipped {
            transform: rotateY(180deg) scale(1);
            cursor: default;
        }
        
        .card.flipped:hover {
            transform: rotateY(180deg) scale(1);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
        }
        
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 4px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 2px;
            text-align: center;
        }
        
        .card-front {
            background: linear-gradient(145deg, #2d3748, #1a202c);
            color: #4dabf7;
            font-size: 0.7rem;
        }
        
        .card-back {
            background: linear-gradient(145deg, #1e3c72, #2a5298);
            transform: rotateY(180deg);
            color: white;
            font-size: 0.5rem;
        }
        
        .card-back.normal {
            background: linear-gradient(145deg, #667eea, #764ba2);
        }
        
        .card-back.special {
            background: linear-gradient(145deg, #f093fb, #f5576c);
        }
        
        .card-back.jackpot {
            background: linear-gradient(145deg, #f6d365, #fda085);
            animation: jackpotGlow 1.5s infinite alternate;
        }
        
        @keyframes jackpotGlow {
            0% { box-shadow: 0 0 5px #f6d365; }
            100% { box-shadow: 0 0 15px #fda085, 0 0 20px #ff9a00; }
        }
        
        .card-value {
            font-size: 0.6rem;
            font-weight: bold;
            margin-bottom: 1px;
            line-height: 1.1;
        }
        
        .card-text {
            font-size: 0.4rem;
            line-height: 1;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 15px;
        }
        
        .btn {
            padding: 8px 15px;
            font-size: 0.8rem;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(90deg, #ff9a00, #ff6a00);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(90deg, #4dabf7, #339af0);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(90deg, #51cf66, #40c057);
            color: white;
        }
        
        .btn-special {
            background: linear-gradient(90deg, #f093fb, #f5576c);
            color: white;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4);
        }
        
        .jackpot-choice {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
            display: none;
        }
        
        .jackpot-message {
            text-align: center;
            background: rgba(255, 215, 0, 0.2);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            border: 1px solid rgba(255, 215, 0, 0.5);
            display: none;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 215, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
        }
        
        .progress-container {
            margin-top: 12px;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 6px;
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 0.85rem;
        }
        
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff9a00, #ff6a00);
            border-radius: 4px;
            width: 0%;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .recent-rewards {
            margin-top: 15px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
        }
        
        .recent-rewards h3 {
            margin-bottom: 8px;
            color: #ffcc00;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
        }
        
        .reward-list {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .reward-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            flex: 1;
            min-width: 150px;
        }
        
        .reward-item.jackpot {
            background: rgba(255, 215, 0, 0.2);
            border-left: 2px solid #ffd700;
        }
        
        @media (max-width: 1100px) {
            .cards-container {
                grid-template-columns: repeat(6, 1fr);
            }
        }
        
        @media (max-width: 800px) {
            .cards-container {
                grid-template-columns: repeat(6, 1fr);
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .layer-selector {
                width: 100%;
            }
        }
        
        @media (max-width: 600px) {
            .cards-container {
                grid-template-columns: repeat(6, 1fr);
                gap: 3px;
            }
            
            .currency-display, .stats-info {
                flex-direction: column;
                gap: 8px;
                align-items: center;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }
            
            .btn, .tool-btn {
                width: 100%;
                justify-content: center;
                padding: 6px 12px;
            }
            
            .jackpot-choice {
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
        }
        
        @media (max-width: 400px) {
            .cards-container {
                grid-template-columns: repeat(6, 1fr);
                gap: 2px;
            }
            
            .card-front {
                font-size: 0.6rem;
            }
            
            .card-back {
                font-size: 0.4rem;
            }
            
            .card-value {
                font-size: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-chess-board"></i> 36æ ¼ç¿»ç‰ŒæŠ½å¥–ç³»ç»Ÿ</h1>
            <p class="subtitle">æŠ½åˆ°å¤§å¥–å¯é€‰æ‹©ç»§ç»­æŠ½æˆ–è¿›å…¥ä¸‹ä¸€å±‚</p>
            
            <div class="currency-display">
                <div class="currency exploration-coin">
                    <i class="fas fa-coins"></i>
                    <span>æ¢é™©å¸: <span id="exploration-coin">0</span></span>
                </div>
                <div class="currency spark-coin">
                    <i class="fas fa-fire"></i>
                    <span>ç«èŠ±å¸: <span id="spark-coin">2851</span></span>
                </div>
            </div>
            
            <div class="stats-info">
                <div class="stats">
                    <i class="fas fa-money-bill-wave"></i>
                    <span>å·²èŠ±è´¹: <span id="total-spent">0</span> ç«èŠ±å¸</span>
                </div>
                <div class="stats">
                    <i class="fas fa-history"></i>
                    <span>é‡ç½®æ¬¡æ•°: <span id="reset-count">0</span></span>
                </div>
            </div>
            
            <div class="game-tools">
                <button class="tool-btn add-spark" id="add-spark-btn">
                    <i class="fas fa-plus-circle"></i> æ·»åŠ 100ç«èŠ±å¸
                </button>
                <button class="tool-btn reset" id="reset-btn">
                    <i class="fas fa-redo"></i> é‡ç½®æ¸¸æˆ
                </button>
            </div>
        </header>
        
        <div class="main-content">
            <div class="layer-selector">
                <h2><i class="fas fa-layer-group"></i> æ¢é™©æ’è¡Œ</h2>
                <div class="layers" id="layer-list">
                    <!-- å±‚çº§å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
            
            <div class="game-area">
                <div class="current-layer-info">
                    <h3><i class="fas fa-chess-board"></i> ç¬¬ <span id="layer-number">1</span> å±‚ (6Ã—6)</h3>
                    <p>æŠ½åˆ°å¤§å¥–åå¯é€‰æ‹©ç»§ç»­æˆ–è¿›å…¥ä¸‹ä¸€å±‚</p>
                    <div id="jackpot-message" class="jackpot-message"></div>
                    <div class="progress-container">
                        <div class="progress-text">
                            <span>å½“å‰è¿›åº¦</span>
                            <span id="progress-text">0/36</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                    </div>
                </div>
                
                <div class="cards-container" id="cards-container">
                    <!-- 36ä¸ªæ ¼å­å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div id="jackpot-choice" class="jackpot-choice">
                    <button class="btn btn-special" id="continue-btn">
                        <i class="fas fa-redo"></i> ç»§ç»­æŠ½å¥–
                    </button>
                    <button class="btn btn-success" id="next-layer-btn">
                        <i class="fas fa-arrow-right"></i> è¿›å…¥ä¸‹ä¸€å±‚
                    </button>
                </div>
                
                <div class="controls">
                    <button class="btn btn-primary" id="flip-one">
                        <i class="fas fa-redo"></i> æ¢ä¸€æ¬¡ (10ç«èŠ±å¸)
                    </button>
                    <button class="btn btn-secondary" id="flip-five">
                        <i class="fas fa-sync-alt"></i> æ¢äº”æ¬¡ (50ç«èŠ±å¸)
                    </button>
                    <button class="btn btn-success" id="next-layer" disabled>
                        <i class="fas fa-arrow-right"></i> ä¸‹ä¸€å±‚
                    </button>
                </div>
                
                <div class="recent-rewards">
                    <h3><i class="fas fa-gift"></i> æœ€è¿‘å¥–åŠ±</h3>
                    <div class="reward-list" id="recent-rewards">
                        <div class="reward-item jackpot">ã€Œæ®‹**ã€æ˜Ÿå…‰ç¿ç¿å¤´åƒæ¡†*1å¤©</div>
                        <div class="reward-item">ã€Œé£**ã€æ¢¦å¹»æµ·æ˜Ÿ</div>
                        <div class="reward-item">ã€Œé¾™**ã€ç¥ç€é¦™æ°´</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ•°æ®
        const gameData = {
            explorationCoin: 0,
            sparkCoin: 2851,
            currentLayer: 1,
            maxLayer: 5,
            cardCount: 36, // æ¯å±‚36ä¸ªæ ¼å­
            jackpotFound: false, // æ˜¯å¦æ‰¾åˆ°å¤§å¥–
            jackpotIndex: -1, // å¤§å¥–çš„ä½ç½®
            totalSpent: 0, // æ€»èŠ±è´¹ç«èŠ±å¸
            resetCount: 0, // é‡ç½®æ¬¡æ•°
            layers: [
                {
                    id: 1,
                    name: "ç¬¬1å±‚",
                    cardCount: 36,
                    requiredFlips: 36,
                    completed: false,
                    unlocked: true,
                    normalRewards: ["æ¢¦å¹»æµ·æ˜Ÿ", "ç¥ç€é¦™æ°´", "çˆ±ä½ é¸­", "ä¸‡åœ£èŠ‚èŠå¤©æ°”æ³¡", "è°¢è°¢é¸­"],
                    jackpotReward: "æ˜Ÿå…‰ç¿ç¿å¤´åƒæ¡†*1å¤©",
                    rewards: [] // åˆå§‹åŒ–æ—¶ä¸ºç©ºï¼Œç¨åç”Ÿæˆ
                },
                {
                    id: 2,
                    name: "ç¬¬2å±‚",
                    cardCount: 36,
                    requiredFlips: 36,
                    completed: false,
                    unlocked: false,
                    normalRewards: ["å—ç“œå°æ€ª", "å¥³ç‹æ¡‚å† ", "æ‹çˆ±å¼“ç®­", "æš´å¯Œé¸­", "èŠ’æœå†»å†»"],
                    jackpotReward: "æš—å¤œæ¶é­”å¤´åƒæ¡†*7å¤©",
                    rewards: []
                },
                {
                    id: 3,
                    name: "ç¬¬3å±‚",
                    cardCount: 36,
                    requiredFlips: 36,
                    completed: false,
                    unlocked: false,
                    normalRewards: ["çˆ±å¿ƒçƒŸé›¾", "é­”æ³•ä¹¦", "ç”œèœœè›‹ç³•", "çˆ±ä½ é¸­", "èŒèŒå°è™"],
                    jackpotReward: "æå…‰å¤©ä½¿å¤´åƒæ¡†",
                    rewards: []
                },
                {
                    id: 4,
                    name: "ç¬¬4å±‚",
                    cardCount: 36,
                    requiredFlips: 36,
                    completed: false,
                    unlocked: false,
                    normalRewards: ["æš—å¤œç³–å–µåº§é©¾*1å¤©", "å¹½é™å¯†å ¡", "åœŸç¥å…½", "å°é¹¿ä¹±æ’", "å—ç“œå°æ€ª"],
                    jackpotReward: "è¯¡å¤œèª“çº¦é™å®šç¤¼ç‰©",
                    rewards: []
                },
                {
                    id: 5,
                    name: "ç¬¬5å±‚",
                    cardCount: 36,
                    requiredFlips: 36,
                    completed: false,
                    unlocked: false,
                    normalRewards: ["æµ·åº•æ˜Ÿç©º", "å—ç“œçƒŸèŠ±", "æœ¨ç¥å…½", "æ±‰å ¡ç²¾çµ", "æŸ æª¬ç‰©è¯­"],
                    jackpotReward: "å°çŒªææä¹é™å®šä¿¡ç‰©",
                    rewards: []
                }
            ],
            flippedCards: 0,
            currentLayerCards: [],
            recentRewards: []
        };

        // ç”Ÿæˆå¥–åŠ±é…ç½® - ç¡®ä¿æ¯ä¸ªå±‚çº§åªæœ‰ä¸€ä¸ªå¤§å¥–
        function generateRewards(layer) {
            const rewards = [];
            
            // ç”Ÿæˆ35ä¸ªå¥–åŠ±ï¼ˆç¡®ä¿åªæœ‰ä¸€ä¸ªå¤§å¥–ï¼‰
            // ç”Ÿæˆ34ä¸ªå¸¸è§„å¥–åŠ±ï¼ˆéšæœºä»normalRewardsä¸­é€‰æ‹©ï¼‰
            for (let i = 0; i < 34; i++) {
                const randomIndex = Math.floor(Math.random() * layer.normalRewards.length);
                rewards.push({
                    type: "normal",
                    value: layer.normalRewards[randomIndex]
                });
            }
            
            // ç”Ÿæˆ1ä¸ªç‰¹æ®Šå¥–åŠ±ï¼ˆæ¢é™©å¸ï¼‰
            rewards.push({
                type: "special",
                value: `æ¢é™©å¸ x${Math.floor(Math.random() * 50 * layer.id) + 20}`
            });
            
            // ç”Ÿæˆ1ä¸ªå¤§å¥– - ç¡®ä¿åªæœ‰ä¸€ä¸ª
            rewards.push({
                type: "jackpot",
                value: layer.jackpotReward
            });
            
            // æ€»å…±36ä¸ªå¥–åŠ±
            return rewards;
        }

        // DOMå…ƒç´ 
        const explorationCoinEl = document.getElementById('exploration-coin');
        const sparkCoinEl = document.getElementById('spark-coin');
        const totalSpentEl = document.getElementById('total-spent');
        const resetCountEl = document.getElementById('reset-count');
        const layerListEl = document.getElementById('layer-list');
        const cardsContainerEl = document.getElementById('cards-container');
        const layerNumberEl = document.getElementById('layer-number');
        const progressTextEl = document.getElementById('progress-text');
        const progressFillEl = document.getElementById('progress-fill');
        const flipOneBtn = document.getElementById('flip-one');
        const flipFiveBtn = document.getElementById('flip-five');
        const nextLayerBtn = document.getElementById('next-layer');
        const recentRewardsEl = document.getElementById('recent-rewards');
        const jackpotMessageEl = document.getElementById('jackpot-message');
        const jackpotChoiceEl = document.getElementById('jackpot-choice');
        const continueBtn = document.getElementById('continue-btn');
        const nextLayerBtn2 = document.getElementById('next-layer-btn');
        const addSparkBtn = document.getElementById('add-spark-btn');
        const resetBtn = document.getElementById('reset-btn');

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // ä¸ºæ¯ä¸ªå±‚çº§ç”Ÿæˆå¥–åŠ±
            gameData.layers.forEach(layer => {
                layer.rewards = generateRewards(layer);
            });
            
            updateCurrencyDisplay();
            updateStatsDisplay();
            renderLayerList();
            loadLayer(gameData.currentLayer);
            updateProgress();
        }

        // æ›´æ–°è´§å¸æ˜¾ç¤º
        function updateCurrencyDisplay() {
            explorationCoinEl.textContent = gameData.explorationCoin;
            sparkCoinEl.textContent = gameData.sparkCoin;
        }

        // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
        function updateStatsDisplay() {
            totalSpentEl.textContent = gameData.totalSpent;
            resetCountEl.textContent = gameData.resetCount;
        }

        // æ·»åŠ ç«èŠ±å¸åŠŸèƒ½
        function addSparkCoins(amount) {
            gameData.sparkCoin += amount;
            updateCurrencyDisplay();
            
            // æ˜¾ç¤ºæç¤º
            showMessage(`æˆåŠŸæ·»åŠ  ${amount} ç«èŠ±å¸ï¼`, 'success');
        }

        // æ˜¾ç¤ºæ¶ˆæ¯æç¤º
        function showMessage(message, type = 'info') {
            // åˆ›å»ºæ¶ˆæ¯å…ƒç´ 
            const messageEl = document.createElement('div');
            messageEl.textContent = message;
            messageEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 10px 15px;
                border-radius: 8px;
                color: white;
                font-weight: bold;
                z-index: 1000;
                animation: slideIn 0.3s ease, fadeOut 0.3s ease 1.7s forwards;
                ${type === 'success' ? 'background: linear-gradient(90deg, #51cf66, #40c057);' : 
                  type === 'warning' ? 'background: linear-gradient(90deg, #ffcc00, #ff9900); color: #333;' : 
                  'background: linear-gradient(90deg, #4dabf7, #339af0);'}
            `;
            
            document.body.appendChild(messageEl);
            
            // 3ç§’åç§»é™¤
            setTimeout(() => {
                if (messageEl.parentNode) {
                    messageEl.parentNode.removeChild(messageEl);
                }
            }, 2000);
        }

        // é‡ç½®æ¸¸æˆåŠŸèƒ½
        function resetGame() {
            if (!confirm("ç¡®å®šè¦é‡ç½®æ¸¸æˆå—ï¼Ÿæ‰€æœ‰è¿›åº¦å’Œå¥–åŠ±å°†ä¸¢å¤±ï¼")) {
                return;
            }
            
            // é‡ç½®æ¸¸æˆæ•°æ®
            gameData.explorationCoin = 0;
            gameData.sparkCoin = 2851;
            gameData.currentLayer = 1;
            gameData.jackpotFound = false;
            gameData.jackpotIndex = -1;
            gameData.flippedCards = 0;
            gameData.currentLayerCards = [];
            gameData.recentRewards = [];
            gameData.resetCount++;
            
            // é‡ç½®æ‰€æœ‰å±‚çº§
            gameData.layers.forEach(layer => {
                layer.completed = false;
                layer.unlocked = layer.id === 1; // åªæœ‰ç¬¬ä¸€å±‚è§£é”
                layer.rewards = generateRewards(layer); // é‡æ–°ç”Ÿæˆå¥–åŠ±
            });
            
            // éšè—å¤§å¥–é€‰æ‹©ç•Œé¢
            jackpotMessageEl.style.display = 'none';
            jackpotChoiceEl.style.display = 'none';
            
            // æ¸…ç©ºæœ€è¿‘å¥–åŠ±åˆ—è¡¨ï¼ˆé™¤äº†ç¤ºä¾‹æ•°æ®ï¼‰
            recentRewardsEl.innerHTML = `
                <div class="reward-item jackpot">ã€Œæ®‹**ã€æ˜Ÿå…‰ç¿ç¿å¤´åƒæ¡†*1å¤©</div>
                <div class="reward-item">ã€Œé£**ã€æ¢¦å¹»æµ·æ˜Ÿ</div>
                <div class="reward-item">ã€Œé¾™**ã€ç¥ç€é¦™æ°´</div>
            `;
            
            // æ›´æ–°æ˜¾ç¤º
            updateCurrencyDisplay();
            updateStatsDisplay();
            renderLayerList();
            loadLayer(gameData.currentLayer);
            
            // æ˜¾ç¤ºé‡ç½®æˆåŠŸæ¶ˆæ¯
            showMessage('æ¸¸æˆå·²é‡ç½®ï¼', 'success');
        }

        // æ¸²æŸ“å±‚çº§åˆ—è¡¨
        function renderLayerList() {
            layerListEl.innerHTML = '';
            
            gameData.layers.forEach(layer => {
                const layerItem = document.createElement('div');
                layerItem.className = 'layer-item';
                
                if (layer.id === gameData.currentLayer) {
                    layerItem.classList.add('active');
                }
                
                if (layer.completed) {
                    layerItem.classList.add('completed');
                }
                
                if (!layer.unlocked) {
                    layerItem.classList.add('locked');
                }
                
                let statusText, statusClass;
                if (layer.completed) {
                    statusText = 'å·²å®Œæˆ';
                    statusClass = 'status-completed';
                } else if (layer.id === gameData.currentLayer) {
                    statusText = 'è¿›è¡Œä¸­';
                    statusClass = 'status-active';
                } else if (!layer.unlocked) {
                    statusText = 'å·²é”å®š';
                    statusClass = 'status-locked';
                } else {
                    statusText = 'æœªå¼€å§‹';
                    statusClass = 'status-active';
                }
                
                layerItem.innerHTML = `
                    <div class="layer-header">
                        <div class="layer-title">${layer.name}</div>
                        <div class="layer-status ${statusClass}">${statusText}</div>
                    </div>
                    <div class="layer-info">
                        <p>6Ã—6 å…±36æ ¼ | å¤§å¥–: ${layer.jackpotReward}</p>
                        <p>å¸¸è§„å¥–åŠ±: ${layer.normalRewards.slice(0, 3).join('ã€')}...</p>
                    </div>
                `;
                
                if (layer.unlocked && !layer.completed) {
                    layerItem.addEventListener('click', () => {
                        switchLayer(layer.id);
                    });
                }
                
                layerListEl.appendChild(layerItem);
            });
        }

        // åˆ‡æ¢å±‚çº§
        function switchLayer(layerId) {
            if (layerId > gameData.currentLayer && !gameData.layers[layerId-2].completed) {
                alert('è¯·å…ˆå®Œæˆå½“å‰å±‚çº§ï¼');
                return;
            }
            
            gameData.currentLayer = layerId;
            gameData.jackpotFound = false;
            loadLayer(layerId);
            renderLayerList();
        }

        // åŠ è½½å±‚çº§
        function loadLayer(layerId) {
            const layer = gameData.layers[layerId-1];
            
            // æ›´æ–°UI
            layerNumberEl.textContent = layerId;
            
            // é‡ç½®ç¿»ç‰Œè®¡æ•°
            gameData.flippedCards = 0;
            gameData.jackpotFound = false;
            
            // éšè—å¤§å¥–é€‰æ‹©ç•Œé¢
            jackpotMessageEl.style.display = 'none';
            jackpotChoiceEl.style.display = 'none';
            
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            flipOneBtn.disabled = false;
            flipFiveBtn.disabled = false;
            nextLayerBtn.disabled = true;
            
            // ç”Ÿæˆå¡ç‰Œ
            generateCards(layer);
            
            // æ›´æ–°è¿›åº¦
            updateProgress();
        }

        // ç”Ÿæˆ36ä¸ªæ ¼å­ï¼ˆ6Ã—6ï¼‰- ç¡®ä¿å¤§å¥–åªæœ‰ä¸€ä¸ª
        function generateCards(layer) {
            cardsContainerEl.innerHTML = '';
            gameData.currentLayerCards = [];
            
            // å¤åˆ¶å¥–åŠ±æ•°ç»„å¹¶éšæœºæ‰“ä¹±
            const rewardsPool = [...layer.rewards];
            shuffleArray(rewardsPool);
            
            // è®°å½•å¤§å¥–ä½ç½®
            gameData.jackpotIndex = -1;
            rewardsPool.forEach((reward, index) => {
                if (reward.type === "jackpot") {
                    gameData.jackpotIndex = index;
                }
            });
            
            // åˆ›å»º36ä¸ªæ ¼å­
            for (let i = 0; i < gameData.cardCount; i++) {
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.index = i;
                
                let reward = null;
                if (i < rewardsPool.length) {
                    reward = rewardsPool[i];
                } else {
                    // å¦‚æœå¥–åŠ±æ± ä¸å¤Ÿï¼Œç”Ÿæˆé»˜è®¤å¸¸è§„å¥–åŠ±
                    const randomIndex = Math.floor(Math.random() * layer.normalRewards.length);
                    reward = {
                        type: "normal",
                        value: layer.normalRewards[randomIndex]
                    };
                }
                
                gameData.currentLayerCards[i] = {
                    flipped: false,
                    reward: reward
                };
                
                let cardBackClass = 'card-back ';
                if (reward.type === 'normal') {
                    cardBackClass += 'normal';
                } else if (reward.type === 'special') {
                    cardBackClass += 'special';
                } else if (reward.type === 'jackpot') {
                    cardBackClass += 'jackpot';
                }
                
                // å¤„ç†æ˜¾ç¤ºæ–‡æœ¬
                let displayValue = reward.value;
                let displayText = "";
                
                if (reward.type === 'normal') {
                    displayText = "å¸¸è§„å¥–åŠ±";
                } else if (reward.type === 'special') {
                    displayText = "ç‰¹æ®Šå¥–åŠ±";
                } else if (reward.type === 'jackpot') {
                    displayText = "ç»ˆæå¤§å¥–";
                }
                
                // å¦‚æœæ–‡æœ¬å¤ªé•¿ï¼Œè¿›è¡Œæˆªæ–­
                if (displayValue.length > 8) {
                    displayValue = displayValue.substring(0, 6) + '...';
                }
                
                card.innerHTML = `
                    <div class="card-front">
                        <i class="fas fa-question"></i>
                    </div>
                    <div class="${cardBackClass}">
                        <div class="card-value">${displayValue}</div>
                        <div class="card-text">${displayText}</div>
                    </div>
                `;
                
                card.addEventListener('click', () => flipCard(i));
                
                cardsContainerEl.appendChild(card);
            }
        }

        // ç¿»ç‰Œ
        function flipCard(cardIndex) {
            const card = document.querySelector(`.card[data-index="${cardIndex}"]`);
            const layer = gameData.layers[gameData.currentLayer-1];
            
            if (!card || gameData.currentLayerCards[cardIndex].flipped || layer.completed) {
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿç«èŠ±å¸
            if (gameData.sparkCoin < 10) {
                alert('ç«èŠ±å¸ä¸è¶³ï¼');
                return;
            }
            
            // æ‰£é™¤ç«èŠ±å¸å¹¶è®°å½•èŠ±è´¹
            gameData.sparkCoin -= 10;
            gameData.totalSpent += 10;
            
            updateCurrencyDisplay();
            updateStatsDisplay();
            
            // ç¿»ç‰ŒåŠ¨ç”»
            card.classList.add('flipped');
            gameData.currentLayerCards[cardIndex].flipped = true;
            
            // å¢åŠ ç¿»ç‰Œè®¡æ•°
            gameData.flippedCards++;
            
            // å‘æ”¾å¥–åŠ±
            const reward = gameData.currentLayerCards[cardIndex].reward;
            let rewardMessage = '';
            let isJackpot = false;
            
            if (reward.type === 'normal') {
                rewardMessage = reward.value;
            } else if (reward.type === 'special') {
                rewardMessage = reward.value;
                // å¦‚æœæ˜¯ç‰¹æ®Šå¥–åŠ±ï¼ˆæ¢é™©å¸ï¼‰ï¼Œæ·»åŠ åˆ°è´¦æˆ·
                const match = reward.value.match(/æ¢é™©å¸ x(\d+)/);
                if (match) {
                    const coinAmount = parseInt(match[1]);
                    gameData.explorationCoin += coinAmount;
                    updateCurrencyDisplay();
                }
            } else if (reward.type === 'jackpot') {
                rewardMessage = layer.jackpotReward;
                isJackpot = true;
                gameData.jackpotFound = true;
                
                // æ˜¾ç¤ºå¤§å¥–ä¿¡æ¯å’Œé€‰æ‹©
                jackpotMessageEl.textContent = `ğŸ‰ æ­å–œæ‚¨æŠ½åˆ°å¤§å¥–: ${layer.jackpotReward}ï¼`;
                jackpotMessageEl.style.display = 'block';
                jackpotChoiceEl.style.display = 'flex';
                
                // ç¦ç”¨å¸¸è§„ç¿»ç‰ŒæŒ‰é’®
                flipOneBtn.disabled = true;
                flipFiveBtn.disabled = true;
            }
            
            // æ›´æ–°è¿›åº¦
            updateProgress();
            
            // æ·»åŠ å¥–åŠ±è®°å½•
            addRecentReward(rewardMessage, isJackpot);
            
            // å¦‚æœæ²¡æœ‰æŠ½åˆ°å¤§å¥–ï¼Œæ£€æŸ¥æ˜¯å¦å®Œæˆå½“å‰å±‚çº§
            if (!isJackpot && gameData.flippedCards >= layer.requiredFlips) {
                layer.completed = true;
                nextLayerBtn.disabled = false;
                flipOneBtn.disabled = true;
                flipFiveBtn.disabled = true;
                
                // è§£é”ä¸‹ä¸€å±‚
                if (gameData.currentLayer < gameData.maxLayer) {
                    gameData.layers[gameData.currentLayer].unlocked = true;
                }
                
                renderLayerList();
                
                setTimeout(() => {
                    alert(`æ­å–œï¼æ‚¨å·²å®Œæˆ${layer.name}ï¼`);
                }, 500);
            }
        }

        // ç¿»äº”å¼ ç‰Œ
        function flipFiveCards() {
            const layer = gameData.layers[gameData.currentLayer-1];
            
            if (layer.completed || gameData.jackpotFound) {
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿç«èŠ±å¸
            if (gameData.sparkCoin < 50) {
                alert('ç«èŠ±å¸ä¸è¶³ï¼');
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰æœªç¿»çš„ç‰Œ
            const unflippedCards = gameData.currentLayerCards.filter(card => !card.flipped);
            if (unflippedCards.length === 0) {
                alert('æ‰€æœ‰æ ¼å­éƒ½å·²ç¿»å¼€ï¼');
                return;
            }
            
            // è®¡ç®—å®é™…è¦ç¿»çš„ç‰Œæ•°
            const cardsToFlip = Math.min(5, unflippedCards.length);
            
            // æ‰£é™¤ç«èŠ±å¸å¹¶è®°å½•èŠ±è´¹
            gameData.sparkCoin -= 50;
            gameData.totalSpent += 50;
            
            updateCurrencyDisplay();
            updateStatsDisplay();
            
            // éšæœºé€‰æ‹©æœªç¿»çš„ç‰Œ
            const unflippedIndices = [];
            gameData.currentLayerCards.forEach((card, index) => {
                if (!card.flipped) {
                    unflippedIndices.push(index);
                }
            });
            
            shuffleArray(unflippedIndices);
            const selectedIndices = unflippedIndices.slice(0, cardsToFlip);
            
            // ç¿»é€‰ä¸­çš„ç‰Œ
            let hasJackpot = false;
            let jackpotReward = '';
            
            selectedIndices.forEach((cardIndex, i) => {
                setTimeout(() => {
                    const card = document.querySelector(`.card[data-index="${cardIndex}"]`);
                    if (card) {
                        card.classList.add('flipped');
                        gameData.currentLayerCards[cardIndex].flipped = true;
                        
                        // è®°å½•å¥–åŠ±
                        const reward = gameData.currentLayerCards[cardIndex].reward;
                        
                        // æ£€æŸ¥æ˜¯å¦æ˜¯å¤§å¥–
                        if (reward.type === 'jackpot') {
                            hasJackpot = true;
                            jackpotReward = reward.value;
                            gameData.jackpotFound = true;
                        }
                        
                        // ç‰¹æ®Šå¥–åŠ±å¤„ç†
                        if (reward.type === 'special') {
                            const match = reward.value.match(/æ¢é™©å¸ x(\d+)/);
                            if (match) {
                                const coinAmount = parseInt(match[1]);
                                gameData.explorationCoin += coinAmount;
                            }
                        }
                        
                        // å¢åŠ ç¿»ç‰Œè®¡æ•°
                        gameData.flippedCards++;
                        
                        // æ›´æ–°è¿›åº¦
                        updateProgress();
                        
                        // æ·»åŠ å¥–åŠ±è®°å½•
                        if (reward.type !== 'special') {
                            addRecentReward(reward.value, reward.type === 'jackpot');
                        }
                        
                        // å¦‚æœæ˜¯æœ€åä¸€å¼ 
                        if (i === selectedIndices.length - 1) {
                            updateCurrencyDisplay();
                            
                            // å¦‚æœæŠ½åˆ°äº†å¤§å¥–
                            if (hasJackpot) {
                                // æ˜¾ç¤ºå¤§å¥–ä¿¡æ¯å’Œé€‰æ‹©
                                jackpotMessageEl.textContent = `ğŸ‰ æ­å–œæ‚¨æŠ½åˆ°å¤§å¥–: ${jackpotReward}ï¼`;
                                jackpotMessageEl.style.display = 'block';
                                jackpotChoiceEl.style.display = 'flex';
                                
                                // ç¦ç”¨å¸¸è§„ç¿»ç‰ŒæŒ‰é’®
                                flipOneBtn.disabled = true;
                                flipFiveBtn.disabled = true;
                            }
                            
                            // å¦‚æœæ²¡æœ‰æŠ½åˆ°å¤§å¥–ï¼Œæ£€æŸ¥æ˜¯å¦å®Œæˆå½“å‰å±‚çº§
                            if (!hasJackpot && gameData.flippedCards >= layer.requiredFlips) {
                                layer.completed = true;
                                nextLayerBtn.disabled = false;
                                flipOneBtn.disabled = true;
                                flipFiveBtn.disabled = true;
                                
                                // è§£é”ä¸‹ä¸€å±‚
                                if (gameData.currentLayer < gameData.maxLayer) {
                                    gameData.layers[gameData.currentLayer].unlocked = true;
                                }
                                
                                renderLayerList();
                                
                                setTimeout(() => {
                                    alert(`æ­å–œï¼æ‚¨å·²å®Œæˆ${layer.name}ï¼`);
                                }, 500);
                            }
                        }
                    }
                }, i * 200);
            });
        }

        // ç»§ç»­æŠ½å¥–ï¼ˆæŠ½åˆ°å¤§å¥–åé€‰æ‹©ï¼‰
        continueBtn.addEventListener('click', function() {
            // éšè—å¤§å¥–é€‰æ‹©ç•Œé¢
            jackpotMessageEl.style.display = 'none';
            jackpotChoiceEl.style.display = 'none';
            
            // æ¢å¤ç¿»ç‰ŒæŒ‰é’®
            flipOneBtn.disabled = false;
            flipFiveBtn.disabled = false;
            
            // æ ‡è®°å¤§å¥–å·²è¢«æ‰¾åˆ°ï¼Œä½†å¯ä»¥ç»§ç»­æŠ½
            gameData.jackpotFound = true;
        });

        // è¿›å…¥ä¸‹ä¸€å±‚ï¼ˆæŠ½åˆ°å¤§å¥–åé€‰æ‹©ï¼‰
        nextLayerBtn2.addEventListener('click', function() {
            const layer = gameData.layers[gameData.currentLayer-1];
            
            // æ ‡è®°å±‚çº§å®Œæˆ
            layer.completed = true;
            
            // è§£é”ä¸‹ä¸€å±‚
            if (gameData.currentLayer < gameData.maxLayer) {
                gameData.layers[gameData.currentLayer].unlocked = true;
            }
            
            // éšè—å¤§å¥–é€‰æ‹©ç•Œé¢
            jackpotMessageEl.style.display = 'none';
            jackpotChoiceEl.style.display = 'none';
            
            // å¯ç”¨ä¸‹ä¸€å±‚æŒ‰é’®
            nextLayerBtn.disabled = false;
            
            // æ›´æ–°å±‚çº§åˆ—è¡¨
            renderLayerList();
            
            // æç¤ºç”¨æˆ·
            alert(`æ‚¨é€‰æ‹©äº†è¿›å…¥ä¸‹ä¸€å±‚ã€‚${layer.name}å·²æ ‡è®°ä¸ºå®Œæˆï¼`);
        });

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const layer = gameData.layers[gameData.currentLayer-1];
            const progress = Math.min(gameData.flippedCards, layer.requiredFlips);
            const percentage = (progress / layer.requiredFlips) * 100;
            
            progressTextEl.textContent = `${progress}/${layer.requiredFlips}`;
            progressFillEl.style.width = `${percentage}%`;
        }

        // æ·»åŠ æœ€è¿‘å¥–åŠ±
        function addRecentReward(rewardText, isJackpot = false) {
            const rewardItem = document.createElement('div');
            rewardItem.className = 'reward-item';
            if (isJackpot) rewardItem.classList.add('jackpot');
            rewardItem.textContent = `ã€Œ${getRandomName()}ã€${rewardText}`;
            
            recentRewardsEl.prepend(rewardItem);
            
            // é™åˆ¶æ˜¾ç¤ºæ•°é‡
            if (recentRewardsEl.children.length > 5) {
                recentRewardsEl.removeChild(recentRewardsEl.lastChild);
            }
        }

        // è·å–éšæœºåå­—
        function getRandomName() {
            const surnames = ['æ®‹', 'é£', 'é¾™', 'å½±', 'æ˜Ÿ', 'æœˆ', 'ç‚', 'å†°', 'é›·', 'å…‰', 'äº‘', 'é›¨', 'é›ª', 'å¤œ', 'æ—¥'];
            const name = surnames[Math.floor(Math.random() * surnames.length)] + '**';
            return name;
        }

        // æ•°ç»„éšæœºæ‰“ä¹±
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // è¿›å…¥ä¸‹ä¸€å±‚ï¼ˆå¸¸è§„æŒ‰é’®ï¼‰
        nextLayerBtn.addEventListener('click', function() {
            const currentLayer = gameData.layers[gameData.currentLayer-1];
            
            if (!currentLayer.completed) {
                alert('è¯·å…ˆå®Œæˆå½“å‰å±‚çº§ï¼');
                return;
            }
            
            if (gameData.currentLayer >= gameData.maxLayer) {
                alert('æ­å–œï¼æ‚¨å·²å®Œæˆæ‰€æœ‰å±‚çº§ï¼');
                return;
            }
            
            gameData.currentLayer++;
            gameData.jackpotFound = false;
            loadLayer(gameData.currentLayer);
            renderLayerList();
        });

        // äº‹ä»¶ç›‘å¬
        flipOneBtn.addEventListener('click', () => {
            // å¦‚æœå·²ç»æŠ½åˆ°å¤§å¥–ä½†æœªé€‰æ‹©
            if (gameData.jackpotFound) {
                alert('æ‚¨å·²ç»æŠ½åˆ°å¤§å¥–ï¼Œè¯·å…ˆé€‰æ‹©ç»§ç»­æŠ½å¥–æˆ–è¿›å…¥ä¸‹ä¸€å±‚ï¼');
                return;
            }
            
            // éšæœºç¿»ä¸€å¼ æœªç¿»çš„ç‰Œ
            const unflippedCards = gameData.currentLayerCards.filter(card => !card.flipped);
            if (unflippedCards.length === 0) {
                alert('æ‰€æœ‰æ ¼å­éƒ½å·²ç¿»å¼€ï¼');
                return;
            }
            
            const randomIndex = Math.floor(Math.random() * unflippedCards.length);
            let cardIndex = -1;
            
            // æ‰¾åˆ°å¯¹åº”çš„å¡ç‰‡ç´¢å¼•
            gameData.currentLayerCards.forEach((card, idx) => {
                if (!card.flipped && cardIndex === -1) {
                    randomIndex--;
                    if (randomIndex < 0) {
                        cardIndex = idx;
                    }
                }
            });
            
            if (cardIndex !== -1) {
                flipCard(cardIndex);
            }
        });

        flipFiveBtn.addEventListener('click', flipFiveCards);

        // æ·»åŠ ç«èŠ±å¸æŒ‰é’®äº‹ä»¶
        addSparkBtn.addEventListener('click', function() {
            addSparkCoins(100);
        });

        // é‡ç½®æ¸¸æˆæŒ‰é’®äº‹ä»¶
        resetBtn.addEventListener('click', resetGame);

        // åˆå§‹åŒ–æ¸¸æˆ
        initGame();
    </script>
</body>
</html>
